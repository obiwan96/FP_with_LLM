# MDAF-based Explainable Failure Prediction Framework for 5G/6G Networks

This repository contains the experimental codebase used in our research on **MDAF-based Explainable Failure Prediction for 5G/6G Network Functions**.  
The framework enables real-time multi-domain data collection, network failure prediction, and explainable AI (XAI) reasoning using **SHAP** and **LLMs**.

---

## ğŸ§  Overview

The system operates in a 5G/6G testbed that integrates:
- **OpenAirInterface (OAI)** â€“ Core Network functions (AMF, SMF, UPF, etc.)
- **UERANSIM** â€“ RAN emulation (gNodeB, UE)
- **Kubernetes** â€“ Deployment and orchestration platform
- **Prometheus / Loki / InfluxDB** â€“ Telemetry collection and time-series data management

The framework collects resource and log metrics from all domains, stores them in InfluxDB, and applies machine learning models for fault prediction and explainable reasoning.

---

## ğŸ§© Architecture
```
 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 â”‚      5G/6G Testbed           â”‚
 â”‚  (OAI Core, UERANSIM RAN)    â”‚
 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â–¼
        [Kubernetes Pods]
                â”‚
                â–¼
        Prometheus & Loki
                â”‚
                â–¼
       [MDAF Collector Layer]
        â””â”€ Prome_helper.py â†’ InfluxDB
                â”‚
                â–¼
      [ML & XAI Analysis Layer]
        â”œâ”€ failure_prediction.py
        â”œâ”€ learning_helper.py
        â””â”€ XAI.py
```
---

## ğŸ“ Repository Structure

| File | Description |
|------|--------------|
| `secret.py` | Contains configuration and authentication details for communication with the testbed (Prometheus, Loki, InfluxDB, Kubernetes API, etc.). Users should fill in their own credentials and endpoints. |
| `POD_management.py` | Handles creation, deployment, and lifecycle management of **UE Pods** in the Kubernetes cluster. |
| `Prome_helper.py` | Interfaces with **Prometheus** and **InfluxDB**, collects resource metrics and logs from RAN/Core/Application domains. *(Acts as the MDAF Collector)* |
| `learning_helper.py` | Provides helper functions for dataset preprocessing, normalization, and model training utilities. |
| `failure_prediction.py` | Runs the core **failure prediction experiments**, loads data from InfluxDB, trains ML models (LSTM, GRU, CNV-GRU, Attention-GRU), and evaluates results. |
| `XAI.py` | Explain the prediction results and suggest the solution based on **SHAP+LLM**. |
| `README.md` | Project documentation. |

---

## âš™ï¸ Environment Requirements

This repository assumes a pre-deployed **5G/6G testbed** with the following components:

- **OpenAirInterface (OAI)**: Core network
- **UERANSIM**: gNodeB / UE emulator
- **Kubernetes (v1.33+)**
- **Prometheus** and **Loki** for metrics/logs
- **InfluxDB** for time-series storage
- **Python 3.9+** with the following major dependencies:
  ```bash
  pip install pandas numpy torch influxdb_client prometheus_api_client kubernetes shap openai

## ğŸš€ Quick Start

1. Clone the repository
    ```bash
    git clone https://github.com/obiwan96/MDAF-Failure-Prediction.git
    cd MDAF-Failure-Prediction
    ```
1.  Set up environment
    Ensure OAI, UERANSIM, Prometheus, Loki, and InfluxDB are operational.
    Create a Kubernetes namespace for 5G test components (e.g., oai).

1. Edit secret configuration

    ```python
    # secret.py
    prometheus_ip = ''
    loki_ip = ''
    ollama_ip = ''
    InDB_info = {
        'url' : "http://localhost:8086",
        'token' : "",
        'org' : ""
    }
    error_alert_info = {
        'url':'',
        'body': {"chat_id":"", "text": 'Error occured!' },
        'headers' : { 'Content-Type': 'application/json' }
        }
    ```

1. Run data collector (MDAF-Collector)
    ```bash
    python3 Prome_helper.py
    ```

1. Run failure prediction experiments
    ```bash
    python3 failure_prediction.py
    ```

1. Perform SHAP + LLM-based explanation:
    ```bash
    python3 XAI.py
    ```
## ğŸ§  Explainable AI Integration

This project integrates:

 - **SHAP (SHapley Additive exPlanations)**: Feature 
 attribution for model interpretability.

 - **LLMs** (via Ollama or OpenAI API):
Converts SHAP results and logs into human-readable causal explanations.

Example output:
```markdown
Top contributing features:
1. AMF CPU Usage
2. SMF Session Drop
3. PDU Session Delay

LLM Explanation:
"High CPU load and frequent session drops indicate AMF overload.
Scaling or process isolation is recommended."
```

## ğŸ“Š Experimental Notes

 - The codebase includes modules for:

 - Data collection via Prometheus / Loki APIs

 - Real-time InfluxDB write and query operations

 - Time-series model training and evaluation

 - Explainability via SHAP + LLM

Several scripts contain Korean comments (auto-generated by GPT).
These will be cleaned and standardized in future releases.

## ğŸ“š Citation

If you use this code in your research, please cite our paper:
```
We submitted our paper in conference, and are waiting for the result.
```


## ğŸ“¬ Contact

For questions or collaboration:

 - POSTECH DPNM Lab

 - Website: http://dpnm.postech.ac.kr

 - Contact: obiwan96@postech.ac.kr